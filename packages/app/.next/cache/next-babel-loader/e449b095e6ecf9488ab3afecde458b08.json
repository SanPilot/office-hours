{"ast":null,"code":"import { API } from \"@koh/api-client\";\nimport { Question } from \"@koh/common\";\nimport useSWR from \"swr\";\nimport { plainToClass } from \"class-transformer\";\nimport { useCallback } from \"react\";\nimport { useEventSource } from \"./useEventSource\";\nexport function useQuestions(qid) {\n  const {\n    data: questions,\n    error: questionsError,\n    mutate: mutateQuestions\n  } = useSWR(qid && `/api/v1/queues/${qid}/questions`, async () => API.questions.index(Number(qid))); // Subscribe to sse\n\n  useEventSource(qid && `/api/v1/queues/${qid}/sse`, \"question\", useCallback(data => {\n    if (data.questions) {\n      mutateQuestions(plainToClass(Question, data.questions), false);\n    }\n  }, [mutateQuestions]));\n  const mutateQuestion = useCallback(newQuestion => {\n    const newQuestions = questions === null || questions === void 0 ? void 0 : questions.map(q => q.id === newQuestion.id ? newQuestion : q);\n    mutateQuestions(newQuestions);\n  }, [questions, mutateQuestions]);\n  return {\n    questions,\n    questionsError,\n    mutateQuestions,\n    mutateQuestion\n  };\n}","map":null,"metadata":{},"sourceType":"module"}